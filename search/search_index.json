{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"about/","title":"reflex-stripe","text":"<p>A Reflex custom component library for Stripe payment integration.</p>"},{"location":"about/#overview","title":"Overview","text":"<p><code>reflex-stripe</code> wraps <code>@stripe/react-stripe-js</code> to provide Pythonic Stripe checkout components for Reflex applications. It follows the same architecture as <code>reflex-clerk-api</code> \u2014 React library wrapping with Python state management.</p>"},{"location":"about/#features","title":"Features","text":"<ul> <li>Express Checkout \u2014 Apple Pay, Google Pay, Link via <code>ExpressCheckoutElement</code></li> <li>Embedded Checkout \u2014 Full Stripe-hosted checkout form in an iframe</li> <li>One-liner page helpers \u2014 <code>add_checkout_page(app)</code> and <code>add_express_checkout_page(app)</code></li> <li>Return page component \u2014 <code>checkout_return_page()</code> with automatic payment status display</li> <li>Backend state management \u2014 <code>StripeState</code> handles PaymentIntents and Checkout Sessions</li> <li>API routes \u2014 Auto-registered <code>/api/stripe/*</code> endpoints for client-server communication</li> <li>Typed configuration \u2014 <code>Appearance</code>, <code>ExpressCheckoutOptions</code>, and more via <code>PropsBase</code> dataclasses</li> </ul>"},{"location":"about/#architecture","title":"Architecture","text":"<pre><code>reflex_stripe/\n\u251c\u2500\u2500 base.py              # StripeBase \u2014 shared component base class\n\u251c\u2500\u2500 models.py            # Appearance, ExpressCheckoutOptions, ButtonType, etc.\n\u251c\u2500\u2500 stripe_provider.py   # StripeProvider wrapping &lt;Elements&gt; + loadStripe\n\u251c\u2500\u2500 stripe_state.py      # StripeState \u2014 PaymentIntent &amp; Checkout Session management\n\u251c\u2500\u2500 express_checkout.py  # ExpressCheckoutElement + JS bridge\n\u251c\u2500\u2500 embedded_checkout.py # EmbeddedCheckoutProvider + EmbeddedCheckout + bridge\n\u2514\u2500\u2500 pages.py             # Page helpers + checkout return page\n</code></pre> Layer Component Purpose Provider <code>StripeProvider</code> Wraps <code>&lt;Elements&gt;</code> with <code>loadStripe()</code> Elements <code>ExpressCheckoutElement</code>, <code>EmbeddedCheckout</code> Stripe UI components Bridges <code>ExpressCheckoutBridge</code>, <code>EmbeddedCheckoutBridge</code> JS glue for payment event handling State <code>StripeState</code> Backend payment logic (PaymentIntents, Sessions) API <code>register_stripe_api()</code> Auto-registers <code>/api/stripe/*</code> endpoints Pages <code>add_checkout_page()</code>, <code>add_express_checkout_page()</code> One-liner page creation"},{"location":"about/#requirements","title":"Requirements","text":"<ul> <li>Python 3.11+</li> <li>Reflex &gt;= 0.8.0</li> <li>Stripe Python SDK &gt;= 12.0.0</li> </ul>"},{"location":"about/#license","title":"License","text":"<p>Apache-2.0</p>"},{"location":"api_reference/","title":"API Reference","text":""},{"location":"api_reference/#page-helpers","title":"Page Helpers","text":"<p>Add an Embedded Checkout page and return page to the app.</p> <p>This is the simplest way to add Stripe checkout to a Reflex app::</p> <pre><code>import reflex_stripe as stripe\n\napp = rx.App()\nstripe.add_checkout_page(\n    app,\n    line_items=[{\"price\": \"price_xxx\", \"quantity\": 1}],\n)\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>app</code> <code>App</code> <p>The Reflex app instance.</p> required <code>publishable_key</code> <code>str | None</code> <p>Stripe publishable key. Reads from <code>STRIPE_PUBLISHABLE_KEY</code> env var if not provided.</p> <code>None</code> <code>secret_key</code> <code>str | None</code> <p>Stripe secret key. Reads from <code>STRIPE_SECRET_KEY</code> env var if not provided.</p> <code>None</code> <code>line_items</code> <code>list[dict] | None</code> <p>List of Stripe line item dicts for the Checkout Session.</p> <code>None</code> <code>route</code> <code>str</code> <p>Route for the checkout page.</p> <code>'/checkout'</code> <code>return_route</code> <code>str</code> <p>Route for the return/success page.</p> <code>'/checkout/return'</code> Source code in <code>custom_components/reflex_stripe/pages.py</code> <pre><code>def add_checkout_page(\n    app: rx.App,\n    publishable_key: str | None = None,\n    secret_key: str | None = None,\n    line_items: list[dict] | None = None,\n    route: str = \"/checkout\",\n    return_route: str = \"/checkout/return\",\n) -&gt; None:\n    \"\"\"Add an Embedded Checkout page and return page to the app.\n\n    This is the simplest way to add Stripe checkout to a Reflex app::\n\n        import reflex_stripe as stripe\n\n        app = rx.App()\n        stripe.add_checkout_page(\n            app,\n            line_items=[{\"price\": \"price_xxx\", \"quantity\": 1}],\n        )\n\n    Args:\n        app: The Reflex app instance.\n        publishable_key: Stripe publishable key. Reads from\n            ``STRIPE_PUBLISHABLE_KEY`` env var if not provided.\n        secret_key: Stripe secret key. Reads from\n            ``STRIPE_SECRET_KEY`` env var if not provided.\n        line_items: List of Stripe line item dicts for the Checkout Session.\n        route: Route for the checkout page.\n        return_route: Route for the return/success page.\n    \"\"\"\n    assert route.startswith(\"/\"), f\"route must start with '/': {route}\"\n    assert return_route.startswith(\"/\"), f\"return_route must start with '/': {return_route}\"\n\n    publishable_key = publishable_key or os.environ.get(\"STRIPE_PUBLISHABLE_KEY\", \"\")\n    secret_key = secret_key or os.environ.get(\"STRIPE_SECRET_KEY\", \"\")\n\n    _register_api_safe(app)\n\n    checkout_component = rx.center(\n        rx.vstack(\n            embedded_checkout_session(\n                publishable_key=publishable_key,\n                secret_key=secret_key,\n                line_items=line_items,\n                return_url=return_route,\n            ),\n            align=\"center\",\n            spacing=\"4\",\n            width=\"100%\",\n            max_width=\"600px\",\n            padding=\"8\",\n        ),\n        height=\"100vh\",\n    )\n    app.add_page(checkout_component, route=route)\n    app.add_page(\n        checkout_return_page,\n        route=return_route,\n        on_load=StripeState.get_session_status,\n    )\n</code></pre> <p>Add an Express Checkout page and return page to the app.</p> <p>This creates a page with Apple Pay, Google Pay, and Link buttons::</p> <pre><code>import reflex_stripe as stripe\n\napp = rx.App()\nstripe.add_express_checkout_page(app, amount=2000)\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>app</code> <code>App</code> <p>The Reflex app instance.</p> required <code>publishable_key</code> <code>str | None</code> <p>Stripe publishable key. Reads from <code>STRIPE_PUBLISHABLE_KEY</code> env var if not provided.</p> <code>None</code> <code>secret_key</code> <code>str | None</code> <p>Stripe secret key. Reads from <code>STRIPE_SECRET_KEY</code> env var if not provided.</p> <code>None</code> <code>amount</code> <code>int</code> <p>Amount in smallest currency unit (e.g. cents).</p> <code>1099</code> <code>currency</code> <code>str</code> <p>Three-letter ISO currency code.</p> <code>'usd'</code> <code>route</code> <code>str</code> <p>Route for the checkout page.</p> <code>'/express-checkout'</code> <code>return_route</code> <code>str</code> <p>Route for the return/success page.</p> <code>'/express-checkout/complete'</code> Source code in <code>custom_components/reflex_stripe/pages.py</code> <pre><code>def add_express_checkout_page(\n    app: rx.App,\n    publishable_key: str | None = None,\n    secret_key: str | None = None,\n    amount: int = 1099,\n    currency: str = \"usd\",\n    route: str = \"/express-checkout\",\n    return_route: str = \"/express-checkout/complete\",\n) -&gt; None:\n    \"\"\"Add an Express Checkout page and return page to the app.\n\n    This creates a page with Apple Pay, Google Pay, and Link buttons::\n\n        import reflex_stripe as stripe\n\n        app = rx.App()\n        stripe.add_express_checkout_page(app, amount=2000)\n\n    Args:\n        app: The Reflex app instance.\n        publishable_key: Stripe publishable key. Reads from\n            ``STRIPE_PUBLISHABLE_KEY`` env var if not provided.\n        secret_key: Stripe secret key. Reads from\n            ``STRIPE_SECRET_KEY`` env var if not provided.\n        amount: Amount in smallest currency unit (e.g. cents).\n        currency: Three-letter ISO currency code.\n        route: Route for the checkout page.\n        return_route: Route for the return/success page.\n    \"\"\"\n    assert route.startswith(\"/\"), f\"route must start with '/': {route}\"\n    assert return_route.startswith(\"/\"), f\"return_route must start with '/': {return_route}\"\n\n    publishable_key = publishable_key or os.environ.get(\"STRIPE_PUBLISHABLE_KEY\", \"\")\n    secret_key = secret_key or os.environ.get(\"STRIPE_SECRET_KEY\", \"\")\n\n    _register_api_safe(app)\n\n    checkout_component = rx.center(\n        rx.vstack(\n            stripe_provider(\n                ExpressCheckoutBridge.create(return_url=return_route),\n                publishable_key=publishable_key,\n                secret_key=secret_key,\n                mode=\"payment\",\n                amount=amount,\n                currency=currency,\n            ),\n            align=\"center\",\n            spacing=\"4\",\n            width=\"100%\",\n            max_width=\"600px\",\n            padding=\"8\",\n        ),\n        height=\"100vh\",\n    )\n    app.add_page(checkout_component, route=route)\n    app.add_page(\n        checkout_return_page,\n        route=return_route,\n        on_load=StripeState.get_payment_status,\n    )\n</code></pre> <p>Return page component for Stripe payment completion.</p> <p>Displays payment status based on <code>StripeState</code> values populated by <code>get_session_status</code> or <code>get_payment_status</code> on_load handlers.</p> <p>Returns:</p> Type Description <code>Component</code> <p>An rx.Component showing payment result.</p> Source code in <code>custom_components/reflex_stripe/pages.py</code> <pre><code>def checkout_return_page() -&gt; rx.Component:\n    \"\"\"Return page component for Stripe payment completion.\n\n    Displays payment status based on ``StripeState`` values populated by\n    ``get_session_status`` or ``get_payment_status`` on_load handlers.\n\n    Returns:\n        An rx.Component showing payment result.\n    \"\"\"\n    return rx.center(\n        rx.vstack(\n            rx.cond(\n                StripeState.payment_status == \"succeeded\",\n                rx.vstack(\n                    rx.heading(\"Payment Successful!\", size=\"6\"),\n                    rx.cond(\n                        StripeState.customer_email != \"\",\n                        rx.text(\n                            \"A confirmation email will be sent to \",\n                            rx.text(\n                                StripeState.customer_email,\n                                weight=\"bold\",\n                                as_=\"span\",\n                            ),\n                            \".\",\n                        ),\n                        rx.text(\"Thank you for your purchase.\"),\n                    ),\n                    rx.link(\n                        rx.button(\"Back to Home\", size=\"3\"),\n                        href=\"/\",\n                    ),\n                    align=\"center\",\n                    spacing=\"4\",\n                ),\n                rx.cond(\n                    StripeState.payment_status == \"failed\",\n                    rx.vstack(\n                        rx.heading(\"Payment Issue\", size=\"6\", color=\"red\"),\n                        rx.text(StripeState.error_message),\n                        rx.link(\n                            rx.button(\"Try Again\", size=\"3\"),\n                            href=\"/checkout\",\n                        ),\n                        align=\"center\",\n                        spacing=\"4\",\n                    ),\n                    # Loading / idle state\n                    rx.vstack(\n                        rx.spinner(size=\"3\"),\n                        rx.text(\"Checking payment status...\"),\n                        align=\"center\",\n                        spacing=\"4\",\n                    ),\n                ),\n            ),\n            align=\"center\",\n            spacing=\"4\",\n            width=\"100%\",\n            max_width=\"600px\",\n            padding=\"8\",\n        ),\n        height=\"100vh\",\n    )\n</code></pre>"},{"location":"api_reference/#provider","title":"Provider","text":"<p>Create a StripeProvider component (factory function).</p> <p>This is the recommended way to create a StripeProvider. It handles loadStripe initialization, StripeState configuration, and wraps children in the Elements provider.</p> <p>Parameters:</p> Name Type Description Default <code>children</code> <p>Child components to render inside the provider.</p> <code>()</code> <code>publishable_key</code> <code>str</code> <p>Stripe publishable key (pk_test_... or pk_live_...).</p> required <code>secret_key</code> <code>str | None</code> <p>Stripe secret key for backend API calls (sk_test_... or sk_live_...). Stored server-side only in StripeState._secret_key (ClassVar).</p> <code>None</code> <code>mode</code> <code>str | None</code> <p>Payment mode ('payment', 'subscription', 'setup').</p> <code>None</code> <code>amount</code> <code>int | None</code> <p>Amount in smallest currency unit (cents).</p> <code>None</code> <code>currency</code> <code>str | None</code> <p>Three-letter ISO currency code.</p> <code>None</code> <code>client_secret</code> <code>str | None</code> <p>Client secret from PaymentIntent/SetupIntent.</p> <code>None</code> <code>appearance</code> <code>Appearance | None</code> <p>Stripe Appearance API configuration.</p> <code>None</code> <code>return_url</code> <code>str</code> <p>URL to redirect to after payment. Used by ExpressCheckoutBridge.</p> <code>''</code> <code>**props</code> <p>Additional props passed to Elements.</p> <code>{}</code> Source code in <code>custom_components/reflex_stripe/stripe_provider.py</code> <pre><code>def stripe_provider(\n    *children,\n    publishable_key: str,\n    secret_key: str | None = None,\n    mode: str | None = None,\n    amount: int | None = None,\n    currency: str | None = None,\n    client_secret: str | None = None,\n    appearance: Appearance | None = None,\n    return_url: str = \"\",\n    **props,\n) -&gt; rx.Component:\n    \"\"\"Create a StripeProvider component (factory function).\n\n    This is the recommended way to create a StripeProvider. It handles\n    loadStripe initialization, StripeState configuration, and wraps\n    children in the Elements provider.\n\n    Args:\n        children: Child components to render inside the provider.\n        publishable_key: Stripe publishable key (pk_test_... or pk_live_...).\n        secret_key: Stripe secret key for backend API calls (sk_test_... or sk_live_...).\n            Stored server-side only in StripeState._secret_key (ClassVar).\n        mode: Payment mode ('payment', 'subscription', 'setup').\n        amount: Amount in smallest currency unit (cents).\n        currency: Three-letter ISO currency code.\n        client_secret: Client secret from PaymentIntent/SetupIntent.\n        appearance: Stripe Appearance API configuration.\n        return_url: URL to redirect to after payment. Used by ExpressCheckoutBridge.\n        **props: Additional props passed to Elements.\n    \"\"\"\n    from .stripe_state import StripeState\n\n    if secret_key:\n        StripeState._set_secret_key(secret_key)\n\n    if mode and amount and currency:\n        StripeState._set_defaults(\n            amount=amount, currency=currency, return_url=return_url\n        )\n\n    return StripeProvider.create(\n        *children,\n        publishable_key=publishable_key,\n        mode=mode,\n        amount=amount,\n        currency=currency,\n        client_secret=client_secret,\n        appearance=appearance,\n        **props,\n    )\n</code></pre> <p>               Bases: <code>StripeBase</code></p> <p>Wraps Stripe's  provider component. <p>The Elements provider makes Stripe.js and Elements available to child components. It requires a <code>publishable_key</code> for Stripe initialization and accepts either deferred-intent mode props (mode, amount, currency) or a client_secret.</p> <p>See: https://docs.stripe.com/sdks/stripejs-react#elements-provider</p> Source code in <code>custom_components/reflex_stripe/stripe_provider.py</code> <pre><code>class StripeProvider(StripeBase):\n    \"\"\"Wraps Stripe's &lt;Elements&gt; provider component.\n\n    The Elements provider makes Stripe.js and Elements available to child components.\n    It requires a `publishable_key` for Stripe initialization and accepts either\n    deferred-intent mode props (mode, amount, currency) or a client_secret.\n\n    See: https://docs.stripe.com/sdks/stripejs-react#elements-provider\n    \"\"\"\n\n    tag = \"Elements\"\n\n    # The stripe prop is injected as a raw JS variable reference via add_custom_code.\n    # It is NOT a regular Python prop \u2014 loadStripe returns a Promise&lt;Stripe&gt;.\n\n    # Options props (passed as `options` to Elements)\n    # For deferred intent mode:\n    mode: str | None = None\n    \"\"\"Payment mode: 'payment', 'subscription', or 'setup'.\"\"\"\n\n    amount: int | None = None\n    \"\"\"Amount in the smallest currency unit (e.g. cents). Required for deferred intent.\"\"\"\n\n    currency: str | None = None\n    \"\"\"Three-letter ISO currency code (e.g. 'usd'). Required for deferred intent.\"\"\"\n\n    # For client_secret mode:\n    client_secret: str | None = None\n    \"\"\"The client_secret from a PaymentIntent or SetupIntent.\"\"\"\n\n    appearance: Appearance | None = None\n    \"\"\"Stripe Appearance API configuration for theming Elements.\"\"\"\n\n    locale: str | None = None\n    \"\"\"Locale for Elements (e.g. 'en', 'fr', 'auto').\"\"\"\n\n    loader: str | None = None\n    \"\"\"Loading indicator: 'auto', 'always', or 'never'.\"\"\"\n\n    # Internal: publishable key stored for JS code generation\n    _publishable_key: str = \"\"\n\n    def add_imports(self) -&gt; rx.ImportDict:\n        return {\"@stripe/stripe-js\": [\"loadStripe\"]}\n\n    def add_custom_code(self) -&gt; list[str]:\n        if not self._publishable_key:\n            return []\n        return [\n            f'const stripePromise = loadStripe(\"{self._publishable_key}\");'\n        ]\n\n    @classmethod\n    def create(cls, *children, publishable_key: str = \"\", **props) -&gt; \"StripeProvider\":\n        \"\"\"Create a StripeProvider component.\n\n        Args:\n            children: Child components (Elements, ExpressCheckout, etc.).\n            publishable_key: Stripe publishable key (pk_test_... or pk_live_...).\n            **props: Additional props passed to the Elements component.\n        \"\"\"\n        component = super().create(*children, **props)\n        component._publishable_key = publishable_key\n        return component\n\n    def _render(self, props=None):\n        \"\"\"Override render to inject stripe={stripePromise} as raw JS reference.\"\"\"\n        tag = super()._render(props)\n        if self._publishable_key:\n            tag.add_props(stripe=rx.Var(\"stripePromise\"))\n        # Build options object from individual props\n        options = {}\n        if self.mode is not None:\n            options[\"mode\"] = self.mode\n        if self.amount is not None:\n            options[\"amount\"] = self.amount\n        if self.currency is not None:\n            options[\"currency\"] = self.currency\n        if self.client_secret is not None:\n            options[\"clientSecret\"] = self.client_secret\n        if self.appearance is not None:\n            options[\"appearance\"] = self.appearance\n        if self.locale is not None:\n            options[\"locale\"] = self.locale\n        if self.loader is not None:\n            options[\"loader\"] = self.loader\n        if options:\n            tag.add_props(options=options)\n        # Remove individual props that were merged into options\n        tag.remove_props(\"mode\", \"amount\", \"currency\", \"client_secret\",\n                         \"appearance\", \"locale\", \"loader\")\n        return tag\n</code></pre>"},{"location":"api_reference/#reflex_stripe.stripe_provider.StripeProvider.mode","title":"<code>mode = None</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Payment mode: 'payment', 'subscription', or 'setup'.</p>"},{"location":"api_reference/#reflex_stripe.stripe_provider.StripeProvider.amount","title":"<code>amount = None</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Amount in the smallest currency unit (e.g. cents). Required for deferred intent.</p>"},{"location":"api_reference/#reflex_stripe.stripe_provider.StripeProvider.currency","title":"<code>currency = None</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Three-letter ISO currency code (e.g. 'usd'). Required for deferred intent.</p>"},{"location":"api_reference/#reflex_stripe.stripe_provider.StripeProvider.client_secret","title":"<code>client_secret = None</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>The client_secret from a PaymentIntent or SetupIntent.</p>"},{"location":"api_reference/#reflex_stripe.stripe_provider.StripeProvider.appearance","title":"<code>appearance = None</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Stripe Appearance API configuration for theming Elements.</p>"},{"location":"api_reference/#reflex_stripe.stripe_provider.StripeProvider.locale","title":"<code>locale = None</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Locale for Elements (e.g. 'en', 'fr', 'auto').</p>"},{"location":"api_reference/#reflex_stripe.stripe_provider.StripeProvider.loader","title":"<code>loader = None</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Loading indicator: 'auto', 'always', or 'never'.</p>"},{"location":"api_reference/#reflex_stripe.stripe_provider.StripeProvider.create","title":"<code>create(*children, publishable_key='', **props)</code>  <code>classmethod</code>","text":"<p>Create a StripeProvider component.</p> <p>Parameters:</p> Name Type Description Default <code>children</code> <p>Child components (Elements, ExpressCheckout, etc.).</p> <code>()</code> <code>publishable_key</code> <code>str</code> <p>Stripe publishable key (pk_test_... or pk_live_...).</p> <code>''</code> <code>**props</code> <p>Additional props passed to the Elements component.</p> <code>{}</code> Source code in <code>custom_components/reflex_stripe/stripe_provider.py</code> <pre><code>@classmethod\ndef create(cls, *children, publishable_key: str = \"\", **props) -&gt; \"StripeProvider\":\n    \"\"\"Create a StripeProvider component.\n\n    Args:\n        children: Child components (Elements, ExpressCheckout, etc.).\n        publishable_key: Stripe publishable key (pk_test_... or pk_live_...).\n        **props: Additional props passed to the Elements component.\n    \"\"\"\n    component = super().create(*children, **props)\n    component._publishable_key = publishable_key\n    return component\n</code></pre>"},{"location":"api_reference/#express-checkout","title":"Express Checkout","text":"<p>               Bases: <code>Component</code></p> <p>JS bridge that handles the Express Checkout onConfirm payment flow.</p> <p>Like ClerkSessionSynchronizer in reflex-clerk-api, this is a custom React component that uses hooks (useStripe, useElements) to orchestrate the deferred-intent payment confirmation and dispatches events to StripeState via ReflexEvent.</p> <p>The flow: 1. Renders  with an automatic onConfirm handler 2. onConfirm: elements.submit() validates payment data 3. fetch(/api/stripe/create-payment-intent) gets client_secret from backend 4. stripe.confirmPayment({elements, clientSecret}) confirms with Stripe 5. On success: user redirects to return_url 6. On error: event.paymentFailed() dismisses wallet + dispatches to StripeState <p>Usage::</p> <pre><code>stripe.stripe_provider(\n    stripe.ExpressCheckoutBridge.create(return_url=\"/checkout/complete\"),\n    publishable_key=\"pk_test_...\",\n    secret_key=\"sk_test_...\",\n    mode=\"payment\", amount=1099, currency=\"usd\",\n)\n</code></pre> Source code in <code>custom_components/reflex_stripe/express_checkout.py</code> <pre><code>class ExpressCheckoutBridge(rx.Component):\n    \"\"\"JS bridge that handles the Express Checkout onConfirm payment flow.\n\n    Like ClerkSessionSynchronizer in reflex-clerk-api, this is a custom React\n    component that uses hooks (useStripe, useElements) to orchestrate the\n    deferred-intent payment confirmation and dispatches events to StripeState\n    via ReflexEvent.\n\n    The flow:\n    1. Renders &lt;ExpressCheckoutElement&gt; with an automatic onConfirm handler\n    2. onConfirm: elements.submit() validates payment data\n    3. fetch(/api/stripe/create-payment-intent) gets client_secret from backend\n    4. stripe.confirmPayment({elements, clientSecret}) confirms with Stripe\n    5. On success: user redirects to return_url\n    6. On error: event.paymentFailed() dismisses wallet + dispatches to StripeState\n\n    Usage::\n\n        stripe.stripe_provider(\n            stripe.ExpressCheckoutBridge.create(return_url=\"/checkout/complete\"),\n            publishable_key=\"pk_test_...\",\n            secret_key=\"sk_test_...\",\n            mode=\"payment\", amount=1099, currency=\"usd\",\n        )\n    \"\"\"\n\n    tag = \"ExpressCheckoutBridge\"\n\n    # Internal configuration (not React props)\n    _return_url: str = \"\"\n    _api_url: str = \"/api/stripe/create-payment-intent\"\n\n    def add_imports(self) -&gt; rx.ImportDict:\n        return {\n            \"@stripe/react-stripe-js\": [\n                \"useStripe\",\n                \"useElements\",\n                \"ExpressCheckoutElement\",\n            ],\n            \"react\": [\"useCallback\", \"useContext\"],\n            \"$/utils/context\": [\"EventLoopContext\"],\n            \"$/utils/state\": [\"ReflexEvent\"],\n        }\n\n    def add_custom_code(self) -&gt; list[str]:\n        from .stripe_state import StripeState\n\n        state_name = StripeState.get_full_name()\n\n        # Build return_url JS expression\n        if self._return_url and not self._return_url.startswith(\"window.\"):\n            return_url_js = f'\"{self._return_url}\"'\n        else:\n            return_url_js = 'window.location.origin + \"/checkout/complete\"'\n\n        return [\n            f\"\"\"\nfunction ExpressCheckoutBridge({{ children, ...props }}) {{\n  const stripe = useStripe();\n  const elements = useElements();\n  const [ addEvents ] = useContext(EventLoopContext);\n\n  const onConfirm = useCallback(async (event) =&gt; {{\n    if (!stripe || !elements) return;\n\n    // Step 1: Validate and collect payment data\n    const {{error: submitError}} = await elements.submit();\n    if (submitError) {{\n      event.paymentFailed({{reason: \"fail\", message: submitError.message}});\n      if (addEvents) {{\n        addEvents([ReflexEvent(\"{state_name}.handle_payment_error\",\n          {{error_message: submitError.message}})]);\n      }}\n      return;\n    }}\n\n    // Step 2: Create PaymentIntent on server (synchronous fetch)\n    let clientSecret;\n    try {{\n      const res = await fetch(\"{self._api_url}\", {{method: \"POST\"}});\n      const data = await res.json();\n      if (data.error) {{\n        event.paymentFailed({{reason: \"fail\", message: data.error}});\n        if (addEvents) {{\n          addEvents([ReflexEvent(\"{state_name}.handle_payment_error\",\n            {{error_message: data.error}})]);\n        }}\n        return;\n      }}\n      clientSecret = data.client_secret;\n    }} catch (fetchErr) {{\n      event.paymentFailed({{reason: \"fail\", message: fetchErr.message}});\n      if (addEvents) {{\n        addEvents([ReflexEvent(\"{state_name}.handle_payment_error\",\n          {{error_message: fetchErr.message}})]);\n      }}\n      return;\n    }}\n\n    // Step 3: Confirm payment with Stripe\n    const {{error}} = await stripe.confirmPayment({{\n      elements,\n      clientSecret,\n      confirmParams: {{\n        return_url: {return_url_js},\n      }},\n    }});\n\n    if (error) {{\n      event.paymentFailed({{reason: \"fail\", message: error.message}});\n      if (addEvents) {{\n        addEvents([ReflexEvent(\"{state_name}.handle_payment_error\",\n          {{error_message: error.message}})]);\n      }}\n    }}\n    // If no error, Stripe redirects to return_url automatically\n  }}, [stripe, elements, addEvents]);\n\n  return (\n    &lt;ExpressCheckoutElement onConfirm={{onConfirm}} {{...props}}&gt;\n      {{children}}\n    &lt;/ExpressCheckoutElement&gt;\n  );\n}}\n\"\"\"\n        ]\n\n    @classmethod\n    def create(\n        cls,\n        *children,\n        return_url: str = \"\",\n        api_url: str = \"/api/stripe/create-payment-intent\",\n        **props,\n    ) -&gt; \"ExpressCheckoutBridge\":\n        \"\"\"Create an ExpressCheckoutBridge component.\n\n        Args:\n            children: Optional child components.\n            return_url: URL to redirect to after successful payment.\n                Defaults to window.location.origin + \"/checkout/complete\".\n            api_url: Backend API URL for PaymentIntent creation.\n                Defaults to /api/stripe/create-payment-intent.\n            **props: Additional props passed to ExpressCheckoutElement.\n        \"\"\"\n        component = super().create(*children, **props)\n        component._return_url = return_url\n        component._api_url = api_url\n        return component\n</code></pre> <p>               Bases: <code>StripeBase</code></p> <p>Wraps Stripe's . <p>Renders wallet-based payment buttons (Apple Pay, Google Pay, Link, PayPal) inside a StripeProvider. Must be a child of StripeProvider.</p> <p>For automatic payment flow handling, use ExpressCheckoutBridge instead, which wraps this component with the full onConfirm \u2192 confirmPayment flow.</p> <p>See: https://docs.stripe.com/elements/express-checkout-element</p> Source code in <code>custom_components/reflex_stripe/express_checkout.py</code> <pre><code>class ExpressCheckoutElement(StripeBase):\n    \"\"\"Wraps Stripe's &lt;ExpressCheckoutElement&gt;.\n\n    Renders wallet-based payment buttons (Apple Pay, Google Pay, Link, PayPal)\n    inside a StripeProvider. Must be a child of StripeProvider.\n\n    For automatic payment flow handling, use ExpressCheckoutBridge instead,\n    which wraps this component with the full onConfirm \u2192 confirmPayment flow.\n\n    See: https://docs.stripe.com/elements/express-checkout-element\n    \"\"\"\n\n    tag = \"ExpressCheckoutElement\"\n\n    options: ExpressCheckoutOptions | None = None\n    \"\"\"Configuration options for button appearance and behavior.\"\"\"\n\n    # Event handlers \u2014 these receive complex JS event objects.\n    # For the full automated flow, use ExpressCheckoutBridge instead.\n    on_confirm: rx.EventHandler[lambda: []]\n    on_click: rx.EventHandler[lambda: []]\n    on_cancel: rx.EventHandler[lambda: []]\n    on_ready: rx.EventHandler[lambda: []]\n    on_shipping_address_change: rx.EventHandler[lambda: []]\n    on_shipping_rate_change: rx.EventHandler[lambda: []]\n</code></pre>"},{"location":"api_reference/#reflex_stripe.express_checkout.ExpressCheckoutBridge.create","title":"<code>create(*children, return_url='', api_url='/api/stripe/create-payment-intent', **props)</code>  <code>classmethod</code>","text":"<p>Create an ExpressCheckoutBridge component.</p> <p>Parameters:</p> Name Type Description Default <code>children</code> <p>Optional child components.</p> <code>()</code> <code>return_url</code> <code>str</code> <p>URL to redirect to after successful payment. Defaults to window.location.origin + \"/checkout/complete\".</p> <code>''</code> <code>api_url</code> <code>str</code> <p>Backend API URL for PaymentIntent creation. Defaults to /api/stripe/create-payment-intent.</p> <code>'/api/stripe/create-payment-intent'</code> <code>**props</code> <p>Additional props passed to ExpressCheckoutElement.</p> <code>{}</code> Source code in <code>custom_components/reflex_stripe/express_checkout.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    *children,\n    return_url: str = \"\",\n    api_url: str = \"/api/stripe/create-payment-intent\",\n    **props,\n) -&gt; \"ExpressCheckoutBridge\":\n    \"\"\"Create an ExpressCheckoutBridge component.\n\n    Args:\n        children: Optional child components.\n        return_url: URL to redirect to after successful payment.\n            Defaults to window.location.origin + \"/checkout/complete\".\n        api_url: Backend API URL for PaymentIntent creation.\n            Defaults to /api/stripe/create-payment-intent.\n        **props: Additional props passed to ExpressCheckoutElement.\n    \"\"\"\n    component = super().create(*children, **props)\n    component._return_url = return_url\n    component._api_url = api_url\n    return component\n</code></pre>"},{"location":"api_reference/#reflex_stripe.express_checkout.ExpressCheckoutElement.options","title":"<code>options = None</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Configuration options for button appearance and behavior.</p>"},{"location":"api_reference/#embedded-checkout","title":"Embedded Checkout","text":"<p>Create an Embedded Checkout component (factory function).</p> <p>This is the recommended way to add Stripe Embedded Checkout to your app. It handles loadStripe initialization, StripeState configuration, and wraps the checkout form in EmbeddedCheckoutBridge.</p> <p>Parameters:</p> Name Type Description Default <code>children</code> <p>Optional child components rendered inside the provider.</p> <code>()</code> <code>publishable_key</code> <code>str</code> <p>Stripe publishable key (pk_test_... or pk_live_...).</p> required <code>secret_key</code> <code>str | None</code> <p>Stripe secret key for backend API calls (sk_test_... or sk_live_...). Stored server-side only in StripeState._secret_key (ClassVar).</p> <code>None</code> <code>line_items</code> <code>list[dict] | None</code> <p>List of Stripe line item dicts for the Checkout Session. Example: [{\"price\": \"price_xxx\", \"quantity\": 1}] or [{\"price_data\": {\"currency\": \"usd\", \"product_data\": {\"name\": \"T-shirt\"},     \"unit_amount\": 2000}, \"quantity\": 1}]</p> <code>None</code> <code>return_url</code> <code>str</code> <p>Path to redirect to after payment (e.g. \"/checkout/return\").</p> <code>'/checkout/return'</code> <code>**props</code> <p>Additional props passed to EmbeddedCheckoutBridge.</p> <code>{}</code> Source code in <code>custom_components/reflex_stripe/embedded_checkout.py</code> <pre><code>def embedded_checkout_session(\n    *children,\n    publishable_key: str,\n    secret_key: str | None = None,\n    line_items: list[dict] | None = None,\n    return_url: str = \"/checkout/return\",\n    **props,\n) -&gt; rx.Component:\n    \"\"\"Create an Embedded Checkout component (factory function).\n\n    This is the recommended way to add Stripe Embedded Checkout to your app.\n    It handles loadStripe initialization, StripeState configuration, and\n    wraps the checkout form in EmbeddedCheckoutBridge.\n\n    Args:\n        children: Optional child components rendered inside the provider.\n        publishable_key: Stripe publishable key (pk_test_... or pk_live_...).\n        secret_key: Stripe secret key for backend API calls (sk_test_... or sk_live_...).\n            Stored server-side only in StripeState._secret_key (ClassVar).\n        line_items: List of Stripe line item dicts for the Checkout Session.\n            Example: [{\"price\": \"price_xxx\", \"quantity\": 1}]\n            or [{\"price_data\": {\"currency\": \"usd\", \"product_data\": {\"name\": \"T-shirt\"},\n                \"unit_amount\": 2000}, \"quantity\": 1}]\n        return_url: Path to redirect to after payment (e.g. \"/checkout/return\").\n        **props: Additional props passed to EmbeddedCheckoutBridge.\n    \"\"\"\n    from .stripe_state import StripeState\n\n    if secret_key:\n        StripeState._set_secret_key(secret_key)\n\n    if line_items is not None:\n        StripeState._set_checkout_defaults(\n            line_items=line_items,\n            return_url=return_url,\n        )\n\n    return EmbeddedCheckoutBridge.create(\n        *children,\n        publishable_key=publishable_key,\n        **props,\n    )\n</code></pre> <p>               Bases: <code>Component</code></p> <p>JS bridge that handles the Embedded Checkout fetchClientSecret flow.</p> <p>Like ExpressCheckoutBridge, this is a custom React component that: 1. Initializes loadStripe with the publishable key 2. Defines fetchClientSecret callback calling /api/stripe/create-checkout-session 3. Renders  +  with the callback 4. Dispatches onComplete to StripeState.handle_payment_success <p>Usage::</p> <pre><code>stripe.embedded_checkout_session(\n    publishable_key=\"pk_test_...\",\n    secret_key=\"sk_test_...\",\n    line_items=[{\"price\": \"price_xxx\", \"quantity\": 1}],\n    return_url=\"/checkout/return\",\n)\n</code></pre> Source code in <code>custom_components/reflex_stripe/embedded_checkout.py</code> <pre><code>class EmbeddedCheckoutBridge(rx.Component):\n    \"\"\"JS bridge that handles the Embedded Checkout fetchClientSecret flow.\n\n    Like ExpressCheckoutBridge, this is a custom React component that:\n    1. Initializes loadStripe with the publishable key\n    2. Defines fetchClientSecret callback calling /api/stripe/create-checkout-session\n    3. Renders &lt;EmbeddedCheckoutProvider&gt; + &lt;EmbeddedCheckout&gt; with the callback\n    4. Dispatches onComplete to StripeState.handle_payment_success\n\n    Usage::\n\n        stripe.embedded_checkout_session(\n            publishable_key=\"pk_test_...\",\n            secret_key=\"sk_test_...\",\n            line_items=[{\"price\": \"price_xxx\", \"quantity\": 1}],\n            return_url=\"/checkout/return\",\n        )\n    \"\"\"\n\n    tag = \"EmbeddedCheckoutBridge\"\n\n    # Internal configuration (not React props)\n    _publishable_key: str = \"\"\n    _api_url: str = \"/api/stripe/create-checkout-session\"\n\n    def add_imports(self) -&gt; rx.ImportDict:\n        return {\n            \"@stripe/stripe-js\": [\"loadStripe\"],\n            \"@stripe/react-stripe-js\": [\n                \"EmbeddedCheckoutProvider\",\n                \"EmbeddedCheckout\",\n            ],\n            \"react\": [\"useCallback\", \"useContext\"],\n            \"$/utils/context\": [\"EventLoopContext\"],\n            \"$/utils/state\": [\"ReflexEvent\"],\n        }\n\n    def add_custom_code(self) -&gt; list[str]:\n        from .stripe_state import StripeState\n\n        state_name = StripeState.get_full_name()\n\n        if not self._publishable_key:\n            return []\n\n        return [\n            f'const stripePromise = loadStripe(\"{self._publishable_key}\");',\n            f\"\"\"\nfunction EmbeddedCheckoutBridge({{ children, ...props }}) {{\n  const [ addEvents ] = useContext(EventLoopContext);\n\n  const fetchClientSecret = useCallback(async () =&gt; {{\n    const res = await fetch(\"{self._api_url}\", {{\n      method: \"POST\",\n      headers: {{ \"Content-Type\": \"application/json\" }},\n    }});\n    const data = await res.json();\n    if (data.error) {{\n      if (addEvents) {{\n        addEvents([ReflexEvent(\"{state_name}.handle_payment_error\",\n          {{error_message: data.error}})]);\n      }}\n      throw new Error(data.error);\n    }}\n    return data.client_secret;\n  }}, [addEvents]);\n\n  const onComplete = useCallback(() =&gt; {{\n    if (addEvents) {{\n      addEvents([ReflexEvent(\"{state_name}.handle_payment_success\",\n        {{}})]);\n    }}\n  }}, [addEvents]);\n\n  return (\n    &lt;EmbeddedCheckoutProvider\n      stripe={{stripePromise}}\n      options={{{{ fetchClientSecret, onComplete }}}}\n    &gt;\n      &lt;EmbeddedCheckout /&gt;\n      {{children}}\n    &lt;/EmbeddedCheckoutProvider&gt;\n  );\n}}\n\"\"\",\n        ]\n\n    @classmethod\n    def create(\n        cls,\n        *children,\n        publishable_key: str = \"\",\n        api_url: str = \"/api/stripe/create-checkout-session\",\n        **props,\n    ) -&gt; \"EmbeddedCheckoutBridge\":\n        \"\"\"Create an EmbeddedCheckoutBridge component.\n\n        Args:\n            children: Optional child components.\n            publishable_key: Stripe publishable key (pk_test_... or pk_live_...).\n            api_url: Backend API URL for Checkout Session creation.\n                Defaults to /api/stripe/create-checkout-session.\n            **props: Additional props.\n        \"\"\"\n        component = super().create(*children, **props)\n        component._publishable_key = publishable_key\n        component._api_url = api_url\n        return component\n</code></pre> <p>               Bases: <code>StripeBase</code></p> <p>Wraps Stripe's . <p>Provides the Embedded Checkout context to child components. Requires either a client_secret or fetchClientSecret callback, which will be handled via JS bridge in Phase 4.</p> <p>Must be used with a Stripe instance (from loadStripe).</p> <p>See: https://docs.stripe.com/checkout/embedded/quickstart</p> Source code in <code>custom_components/reflex_stripe/embedded_checkout.py</code> <pre><code>class EmbeddedCheckoutProvider(StripeBase):\n    \"\"\"Wraps Stripe's &lt;EmbeddedCheckoutProvider&gt;.\n\n    Provides the Embedded Checkout context to child components.\n    Requires either a client_secret or fetchClientSecret callback,\n    which will be handled via JS bridge in Phase 4.\n\n    Must be used with a Stripe instance (from loadStripe).\n\n    See: https://docs.stripe.com/checkout/embedded/quickstart\n    \"\"\"\n\n    tag = \"EmbeddedCheckoutProvider\"\n\n    # The stripe prop is injected as raw JS via add_custom_code, similar to StripeProvider.\n    # The options (clientSecret or fetchClientSecret) will be handled in Phase 4.\n\n    _publishable_key: str = \"\"\n\n    def add_imports(self) -&gt; rx.ImportDict:\n        return {\"@stripe/stripe-js\": [\"loadStripe\"]}\n\n    def add_custom_code(self) -&gt; list[str]:\n        if not self._publishable_key:\n            return []\n        return [\n            f'const stripePromise = loadStripe(\"{self._publishable_key}\");'\n        ]\n\n    @classmethod\n    def create(cls, *children, publishable_key: str = \"\", **props) -&gt; \"EmbeddedCheckoutProvider\":\n        \"\"\"Create an EmbeddedCheckoutProvider.\n\n        Args:\n            children: Child components (must include EmbeddedCheckout).\n            publishable_key: Stripe publishable key.\n            **props: Additional props.\n        \"\"\"\n        component = super().create(*children, **props)\n        component._publishable_key = publishable_key\n        return component\n\n    def _render(self, props=None):\n        \"\"\"Override render to inject stripe={stripePromise} as raw JS reference.\"\"\"\n        tag = super()._render(props)\n        if self._publishable_key:\n            tag.add_props(stripe=rx.Var(\"stripePromise\"))\n        return tag\n</code></pre> <p>               Bases: <code>StripeBase</code></p> <p>Wraps Stripe's  mount point. <p>Must be a child of EmbeddedCheckoutProvider. Renders the Stripe-hosted checkout form inside an iframe.</p> <p>See: https://docs.stripe.com/checkout/embedded/quickstart</p> Source code in <code>custom_components/reflex_stripe/embedded_checkout.py</code> <pre><code>class EmbeddedCheckout(StripeBase):\n    \"\"\"Wraps Stripe's &lt;EmbeddedCheckout&gt; mount point.\n\n    Must be a child of EmbeddedCheckoutProvider. Renders the Stripe-hosted\n    checkout form inside an iframe.\n\n    See: https://docs.stripe.com/checkout/embedded/quickstart\n    \"\"\"\n\n    tag = \"EmbeddedCheckout\"\n</code></pre>"},{"location":"api_reference/#reflex_stripe.embedded_checkout.EmbeddedCheckoutBridge.create","title":"<code>create(*children, publishable_key='', api_url='/api/stripe/create-checkout-session', **props)</code>  <code>classmethod</code>","text":"<p>Create an EmbeddedCheckoutBridge component.</p> <p>Parameters:</p> Name Type Description Default <code>children</code> <p>Optional child components.</p> <code>()</code> <code>publishable_key</code> <code>str</code> <p>Stripe publishable key (pk_test_... or pk_live_...).</p> <code>''</code> <code>api_url</code> <code>str</code> <p>Backend API URL for Checkout Session creation. Defaults to /api/stripe/create-checkout-session.</p> <code>'/api/stripe/create-checkout-session'</code> <code>**props</code> <p>Additional props.</p> <code>{}</code> Source code in <code>custom_components/reflex_stripe/embedded_checkout.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    *children,\n    publishable_key: str = \"\",\n    api_url: str = \"/api/stripe/create-checkout-session\",\n    **props,\n) -&gt; \"EmbeddedCheckoutBridge\":\n    \"\"\"Create an EmbeddedCheckoutBridge component.\n\n    Args:\n        children: Optional child components.\n        publishable_key: Stripe publishable key (pk_test_... or pk_live_...).\n        api_url: Backend API URL for Checkout Session creation.\n            Defaults to /api/stripe/create-checkout-session.\n        **props: Additional props.\n    \"\"\"\n    component = super().create(*children, **props)\n    component._publishable_key = publishable_key\n    component._api_url = api_url\n    return component\n</code></pre>"},{"location":"api_reference/#reflex_stripe.embedded_checkout.EmbeddedCheckoutProvider.create","title":"<code>create(*children, publishable_key='', **props)</code>  <code>classmethod</code>","text":"<p>Create an EmbeddedCheckoutProvider.</p> <p>Parameters:</p> Name Type Description Default <code>children</code> <p>Child components (must include EmbeddedCheckout).</p> <code>()</code> <code>publishable_key</code> <code>str</code> <p>Stripe publishable key.</p> <code>''</code> <code>**props</code> <p>Additional props.</p> <code>{}</code> Source code in <code>custom_components/reflex_stripe/embedded_checkout.py</code> <pre><code>@classmethod\ndef create(cls, *children, publishable_key: str = \"\", **props) -&gt; \"EmbeddedCheckoutProvider\":\n    \"\"\"Create an EmbeddedCheckoutProvider.\n\n    Args:\n        children: Child components (must include EmbeddedCheckout).\n        publishable_key: Stripe publishable key.\n        **props: Additional props.\n    \"\"\"\n    component = super().create(*children, **props)\n    component._publishable_key = publishable_key\n    return component\n</code></pre>"},{"location":"api_reference/#state","title":"State","text":"<p>               Bases: <code>State</code></p> <p>Backend state for Stripe payment management.</p> <p>Manages PaymentIntent and Checkout Session creation via the Stripe Python SDK, tracks payment status, and stores client_secret for frontend use.</p> <p>ClassVars (_secret_key, _stripe_client, etc.) are shared across all sessions and set once at app initialization via stripe_provider() factory.</p> Source code in <code>custom_components/reflex_stripe/stripe_state.py</code> <pre><code>class StripeState(rx.State):\n    \"\"\"Backend state for Stripe payment management.\n\n    Manages PaymentIntent and Checkout Session creation via the Stripe Python SDK,\n    tracks payment status, and stores client_secret for frontend use.\n\n    ClassVars (_secret_key, _stripe_client, etc.) are shared across all\n    sessions and set once at app initialization via stripe_provider() factory.\n    \"\"\"\n\n    # Per-instance state (synced to frontend via WebSocket)\n    client_secret: str = \"\"\n    \"\"\"The client_secret from the current PaymentIntent.\"\"\"\n\n    payment_status: str = \"idle\"\n    \"\"\"Payment lifecycle status: 'idle', 'requires_payment_method',\n    'processing', 'succeeded', 'failed', etc.\"\"\"\n\n    error_message: str = \"\"\n    \"\"\"Last payment error message, if any.\"\"\"\n\n    customer_email: str = \"\"\n    \"\"\"Customer email from completed Checkout Session, if available.\"\"\"\n\n    # ClassVar \u2014 shared across all instances, not persisted per session.\n    # NOTE: RUF012 is ignored project-wide in pyproject.toml for ClassVar annotations.\n    _secret_key: ClassVar[str | None] = None\n    _stripe_client: ClassVar[stripe_lib.StripeClient | None] = None\n    _default_amount: ClassVar[int] = 0\n    _default_currency: ClassVar[str] = \"usd\"\n    _return_url: ClassVar[str] = \"\"\n    _default_line_items: ClassVar[list[dict]] = []\n\n    @classmethod\n    def _set_secret_key(cls, secret_key: str) -&gt; None:\n        \"\"\"Store Stripe secret key. Called by stripe_provider() factory.\"\"\"\n        if not secret_key:\n            raise ValueError(\"Stripe secret_key must not be empty\")\n        cls._secret_key = secret_key\n        cls._stripe_client = None  # Force re-initialization\n\n    @classmethod\n    def _set_defaults(\n        cls,\n        amount: int = 0,\n        currency: str = \"usd\",\n        return_url: str = \"\",\n    ) -&gt; None:\n        \"\"\"Store default payment parameters for the API endpoint.\"\"\"\n        cls._default_amount = amount\n        cls._default_currency = currency\n        cls._return_url = return_url\n\n    @classmethod\n    def _set_checkout_defaults(\n        cls,\n        line_items: list[dict] | None = None,\n        return_url: str = \"\",\n    ) -&gt; None:\n        \"\"\"Store default Checkout Session parameters for the API endpoint.\"\"\"\n        if line_items is not None:\n            cls._default_line_items = line_items\n        if return_url:\n            cls._return_url = return_url\n\n    @classmethod\n    def _get_client(cls) -&gt; stripe_lib.StripeClient:\n        \"\"\"Get or create the Stripe API client (lazy initialization).\"\"\"\n        if cls._stripe_client is None:\n            key = cls._secret_key or os.environ.get(\"STRIPE_SECRET_KEY\", \"\")\n            if not key:\n                raise ValueError(\n                    \"STRIPE_SECRET_KEY must be passed to stripe_provider() \"\n                    \"or set as an environment variable\"\n                )\n            cls._stripe_client = stripe_lib.StripeClient(\n                key, http_client=stripe_lib.HTTPXClient()\n            )\n        return cls._stripe_client\n\n    @rx.event(background=True)\n    async def create_payment_intent(\n        self, amount: int | None = None, currency: str | None = None\n    ):\n        \"\"\"Create a PaymentIntent and store the client_secret in state.\n\n        Can be called directly as a Reflex event for programmatic use.\n        The JS bridge uses the API endpoint instead (synchronous response needed).\n        \"\"\"\n        amt = amount or self._default_amount\n        cur = currency or self._default_currency\n        if not amt:\n            async with self:\n                self.error_message = \"Amount is required\"\n                self.payment_status = \"failed\"\n            return\n\n        try:\n            client = self._get_client()\n            intent = await client.v1.payment_intents.create_async({\n                \"amount\": amt,\n                \"currency\": cur,\n                \"automatic_payment_methods\": {\"enabled\": True},\n            })\n            async with self:\n                self.client_secret = intent.client_secret or \"\"\n                self.payment_status = intent.status\n                self.error_message = \"\"\n            logger.info(\"PaymentIntent created: %s\", intent.id)\n        except Exception as e:\n            logger.error(\"Failed to create PaymentIntent: %s\", e)\n            async with self:\n                self.error_message = str(e)\n                self.payment_status = \"failed\"\n\n    @rx.event(background=True)\n    async def create_checkout_session(\n        self,\n        line_items: list[dict] | None = None,\n        return_url: str | None = None,\n    ):\n        \"\"\"Create a Checkout Session and store the client_secret in state.\n\n        Can be called directly as a Reflex event for programmatic use.\n        The JS bridge uses the API endpoint instead (synchronous response needed).\n        \"\"\"\n        items = line_items or self._default_line_items\n        if not items:\n            async with self:\n                self.error_message = \"line_items is required\"\n                self.payment_status = \"failed\"\n            return\n\n        ret_url = return_url or self._return_url or \"\"\n        try:\n            client = self._get_client()\n            params: dict = {\n                \"ui_mode\": \"embedded\",\n                \"mode\": \"payment\",\n                \"line_items\": items,\n            }\n            if ret_url:\n                if \"{CHECKOUT_SESSION_ID}\" not in ret_url:\n                    sep = \"&amp;\" if \"?\" in ret_url else \"?\"\n                    ret_url = ret_url + sep + \"session_id={CHECKOUT_SESSION_ID}\"\n                params[\"return_url\"] = ret_url\n            session = await client.v1.checkout.sessions.create_async(params)  # type: ignore[arg-type]\n            async with self:\n                self.client_secret = session.client_secret or \"\"\n                self.payment_status = session.status or \"open\"\n                self.error_message = \"\"\n            logger.info(\"Checkout Session created: %s\", session.id)\n        except Exception as e:\n            logger.error(\"Failed to create Checkout Session: %s\", e)\n            async with self:\n                self.error_message = str(e)\n                self.payment_status = \"failed\"\n\n    @rx.event\n    def handle_payment_success(self, payment_intent_id: str = \"\"):\n        \"\"\"Called from JS bridge after successful confirmPayment.\"\"\"\n        self.payment_status = \"succeeded\"\n        self.error_message = \"\"\n        logger.info(\"Payment succeeded: %s\", payment_intent_id)\n\n    @rx.event\n    def handle_payment_error(self, error_message: str = \"\"):\n        \"\"\"Called from JS bridge on payment failure.\"\"\"\n        self.payment_status = \"failed\"\n        self.error_message = error_message\n        logger.warning(\"Payment failed: %s\", error_message)\n\n    @rx.event\n    def reset_payment(self):\n        \"\"\"Reset payment state for a new transaction.\"\"\"\n        self.client_secret = \"\"\n        self.payment_status = \"idle\"\n        self.error_message = \"\"\n        self.customer_email = \"\"\n\n    @rx.event(background=True)\n    async def get_session_status(self):\n        \"\"\"Retrieve Checkout Session status from URL query params.\n\n        Reads ``session_id`` from ``self.router.page.params`` and calls the\n        Stripe API to get session status.  Designed as an ``on_load`` handler\n        for Embedded Checkout return pages.\n        \"\"\"\n        params = self.router.page.params\n        session_id = params.get(\"session_id\", \"\")\n        if not session_id:\n            return\n\n        try:\n            client = self._get_client()\n            session = await client.v1.checkout.sessions.retrieve_async(session_id)\n            email = \"\"\n            if session.customer_details:\n                email = session.customer_details.email or \"\"\n            status = session.status or \"\"\n            # Map Checkout Session status \u2192 payment_status field\n            if status == \"complete\":\n                mapped = \"succeeded\"\n            elif status == \"expired\":\n                mapped = \"failed\"\n            else:\n                mapped = \"idle\"\n            async with self:\n                self.payment_status = mapped\n                self.customer_email = email\n                self.error_message = (\n                    \"Session expired\" if status == \"expired\" else \"\"\n                )\n            logger.info(\"Session %s status: %s\", session_id, status)\n        except Exception as e:\n            logger.error(\"Failed to retrieve session status: %s\", e)\n            async with self:\n                self.payment_status = \"failed\"\n                self.error_message = str(e)\n\n    @rx.event(background=True)\n    async def get_payment_status(self):\n        \"\"\"Retrieve PaymentIntent status from URL query params.\n\n        Reads ``payment_intent`` from ``self.router.page.params`` and calls\n        the Stripe API to get intent status.  Designed as an ``on_load``\n        handler for Express Checkout return pages.\n        \"\"\"\n        params = self.router.page.params\n        pi_id = params.get(\"payment_intent\", \"\")\n        if not pi_id:\n            # Also check redirect_status for a quick signal\n            redirect_status = params.get(\"redirect_status\", \"\")\n            if redirect_status == \"succeeded\":\n                async with self:\n                    self.payment_status = \"succeeded\"\n                    self.error_message = \"\"\n            return\n\n        try:\n            client = self._get_client()\n            intent = await client.v1.payment_intents.retrieve_async(pi_id)\n            status = intent.status or \"\"\n            # Map PaymentIntent status \u2192 payment_status field\n            if status == \"succeeded\":\n                mapped = \"succeeded\"\n            elif status == \"processing\":\n                mapped = \"processing\"\n            elif status in (\"requires_payment_method\", \"requires_action\"):\n                mapped = \"failed\"\n            else:\n                mapped = status\n            async with self:\n                self.payment_status = mapped\n                self.error_message = (\n                    \"Payment requires another attempt\"\n                    if mapped == \"failed\"\n                    else \"\"\n                )\n            logger.info(\"PaymentIntent %s status: %s\", pi_id, status)\n        except Exception as e:\n            logger.error(\"Failed to retrieve payment intent status: %s\", e)\n            async with self:\n                self.payment_status = \"failed\"\n                self.error_message = str(e)\n</code></pre> <p>Register Stripe API routes on the Reflex app.</p> <p>Call this in your app setup after creating the rx.App::</p> <pre><code>import reflex_stripe as stripe\napp = rx.App()\nstripe.register_stripe_api(app)\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>app</code> <p>The Reflex app (rx.App) instance.</p> required Source code in <code>custom_components/reflex_stripe/stripe_state.py</code> <pre><code>def register_stripe_api(app) -&gt; None:\n    \"\"\"Register Stripe API routes on the Reflex app.\n\n    Call this in your app setup after creating the rx.App::\n\n        import reflex_stripe as stripe\n        app = rx.App()\n        stripe.register_stripe_api(app)\n\n    Args:\n        app: The Reflex app (rx.App) instance.\n    \"\"\"\n    starlette_app = getattr(app, \"_api\", None) or getattr(app, \"api\", None)\n    if starlette_app is None:\n        raise RuntimeError(\n            \"Cannot register Stripe API: app has no Starlette backend. \"\n            \"Make sure rx.App() is initialized before calling register_stripe_api().\"\n        )\n    for route in get_stripe_api_routes():\n        starlette_app.add_route(\n            route.path,\n            route.endpoint,\n            methods=route.methods,\n        )\n</code></pre> <p>Create Starlette routes for Stripe API endpoints.</p> <p>Returns:</p> Type Description <code>list[Route]</code> <p>List of Route objects for mounting on a Starlette app.</p> Source code in <code>custom_components/reflex_stripe/stripe_state.py</code> <pre><code>def get_stripe_api_routes() -&gt; list[Route]:\n    \"\"\"Create Starlette routes for Stripe API endpoints.\n\n    Returns:\n        List of Route objects for mounting on a Starlette app.\n    \"\"\"\n    return [\n        Route(\n            \"/api/stripe/create-payment-intent\",\n            _create_payment_intent_endpoint,\n            methods=[\"POST\"],\n        ),\n        Route(\n            \"/api/stripe/create-checkout-session\",\n            _create_checkout_session_endpoint,\n            methods=[\"POST\"],\n        ),\n        Route(\n            \"/api/stripe/session-status\",\n            _get_session_status_endpoint,\n            methods=[\"GET\"],\n        ),\n    ]\n</code></pre>"},{"location":"api_reference/#reflex_stripe.stripe_state.StripeState.client_secret","title":"<code>client_secret = ''</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>The client_secret from the current PaymentIntent.</p>"},{"location":"api_reference/#reflex_stripe.stripe_state.StripeState.payment_status","title":"<code>payment_status = 'idle'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Payment lifecycle status: 'idle', 'requires_payment_method', 'processing', 'succeeded', 'failed', etc.</p>"},{"location":"api_reference/#reflex_stripe.stripe_state.StripeState.error_message","title":"<code>error_message = ''</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Last payment error message, if any.</p>"},{"location":"api_reference/#reflex_stripe.stripe_state.StripeState.customer_email","title":"<code>customer_email = ''</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Customer email from completed Checkout Session, if available.</p>"},{"location":"api_reference/#reflex_stripe.stripe_state.StripeState.create_payment_intent","title":"<code>create_payment_intent(amount=None, currency=None)</code>  <code>async</code>","text":"<p>Create a PaymentIntent and store the client_secret in state.</p> <p>Can be called directly as a Reflex event for programmatic use. The JS bridge uses the API endpoint instead (synchronous response needed).</p> Source code in <code>custom_components/reflex_stripe/stripe_state.py</code> <pre><code>@rx.event(background=True)\nasync def create_payment_intent(\n    self, amount: int | None = None, currency: str | None = None\n):\n    \"\"\"Create a PaymentIntent and store the client_secret in state.\n\n    Can be called directly as a Reflex event for programmatic use.\n    The JS bridge uses the API endpoint instead (synchronous response needed).\n    \"\"\"\n    amt = amount or self._default_amount\n    cur = currency or self._default_currency\n    if not amt:\n        async with self:\n            self.error_message = \"Amount is required\"\n            self.payment_status = \"failed\"\n        return\n\n    try:\n        client = self._get_client()\n        intent = await client.v1.payment_intents.create_async({\n            \"amount\": amt,\n            \"currency\": cur,\n            \"automatic_payment_methods\": {\"enabled\": True},\n        })\n        async with self:\n            self.client_secret = intent.client_secret or \"\"\n            self.payment_status = intent.status\n            self.error_message = \"\"\n        logger.info(\"PaymentIntent created: %s\", intent.id)\n    except Exception as e:\n        logger.error(\"Failed to create PaymentIntent: %s\", e)\n        async with self:\n            self.error_message = str(e)\n            self.payment_status = \"failed\"\n</code></pre>"},{"location":"api_reference/#reflex_stripe.stripe_state.StripeState.create_checkout_session","title":"<code>create_checkout_session(line_items=None, return_url=None)</code>  <code>async</code>","text":"<p>Create a Checkout Session and store the client_secret in state.</p> <p>Can be called directly as a Reflex event for programmatic use. The JS bridge uses the API endpoint instead (synchronous response needed).</p> Source code in <code>custom_components/reflex_stripe/stripe_state.py</code> <pre><code>@rx.event(background=True)\nasync def create_checkout_session(\n    self,\n    line_items: list[dict] | None = None,\n    return_url: str | None = None,\n):\n    \"\"\"Create a Checkout Session and store the client_secret in state.\n\n    Can be called directly as a Reflex event for programmatic use.\n    The JS bridge uses the API endpoint instead (synchronous response needed).\n    \"\"\"\n    items = line_items or self._default_line_items\n    if not items:\n        async with self:\n            self.error_message = \"line_items is required\"\n            self.payment_status = \"failed\"\n        return\n\n    ret_url = return_url or self._return_url or \"\"\n    try:\n        client = self._get_client()\n        params: dict = {\n            \"ui_mode\": \"embedded\",\n            \"mode\": \"payment\",\n            \"line_items\": items,\n        }\n        if ret_url:\n            if \"{CHECKOUT_SESSION_ID}\" not in ret_url:\n                sep = \"&amp;\" if \"?\" in ret_url else \"?\"\n                ret_url = ret_url + sep + \"session_id={CHECKOUT_SESSION_ID}\"\n            params[\"return_url\"] = ret_url\n        session = await client.v1.checkout.sessions.create_async(params)  # type: ignore[arg-type]\n        async with self:\n            self.client_secret = session.client_secret or \"\"\n            self.payment_status = session.status or \"open\"\n            self.error_message = \"\"\n        logger.info(\"Checkout Session created: %s\", session.id)\n    except Exception as e:\n        logger.error(\"Failed to create Checkout Session: %s\", e)\n        async with self:\n            self.error_message = str(e)\n            self.payment_status = \"failed\"\n</code></pre>"},{"location":"api_reference/#reflex_stripe.stripe_state.StripeState.handle_payment_success","title":"<code>handle_payment_success(payment_intent_id='')</code>","text":"<p>Called from JS bridge after successful confirmPayment.</p> Source code in <code>custom_components/reflex_stripe/stripe_state.py</code> <pre><code>@rx.event\ndef handle_payment_success(self, payment_intent_id: str = \"\"):\n    \"\"\"Called from JS bridge after successful confirmPayment.\"\"\"\n    self.payment_status = \"succeeded\"\n    self.error_message = \"\"\n    logger.info(\"Payment succeeded: %s\", payment_intent_id)\n</code></pre>"},{"location":"api_reference/#reflex_stripe.stripe_state.StripeState.handle_payment_error","title":"<code>handle_payment_error(error_message='')</code>","text":"<p>Called from JS bridge on payment failure.</p> Source code in <code>custom_components/reflex_stripe/stripe_state.py</code> <pre><code>@rx.event\ndef handle_payment_error(self, error_message: str = \"\"):\n    \"\"\"Called from JS bridge on payment failure.\"\"\"\n    self.payment_status = \"failed\"\n    self.error_message = error_message\n    logger.warning(\"Payment failed: %s\", error_message)\n</code></pre>"},{"location":"api_reference/#reflex_stripe.stripe_state.StripeState.reset_payment","title":"<code>reset_payment()</code>","text":"<p>Reset payment state for a new transaction.</p> Source code in <code>custom_components/reflex_stripe/stripe_state.py</code> <pre><code>@rx.event\ndef reset_payment(self):\n    \"\"\"Reset payment state for a new transaction.\"\"\"\n    self.client_secret = \"\"\n    self.payment_status = \"idle\"\n    self.error_message = \"\"\n    self.customer_email = \"\"\n</code></pre>"},{"location":"api_reference/#reflex_stripe.stripe_state.StripeState.get_session_status","title":"<code>get_session_status()</code>  <code>async</code>","text":"<p>Retrieve Checkout Session status from URL query params.</p> <p>Reads <code>session_id</code> from <code>self.router.page.params</code> and calls the Stripe API to get session status.  Designed as an <code>on_load</code> handler for Embedded Checkout return pages.</p> Source code in <code>custom_components/reflex_stripe/stripe_state.py</code> <pre><code>@rx.event(background=True)\nasync def get_session_status(self):\n    \"\"\"Retrieve Checkout Session status from URL query params.\n\n    Reads ``session_id`` from ``self.router.page.params`` and calls the\n    Stripe API to get session status.  Designed as an ``on_load`` handler\n    for Embedded Checkout return pages.\n    \"\"\"\n    params = self.router.page.params\n    session_id = params.get(\"session_id\", \"\")\n    if not session_id:\n        return\n\n    try:\n        client = self._get_client()\n        session = await client.v1.checkout.sessions.retrieve_async(session_id)\n        email = \"\"\n        if session.customer_details:\n            email = session.customer_details.email or \"\"\n        status = session.status or \"\"\n        # Map Checkout Session status \u2192 payment_status field\n        if status == \"complete\":\n            mapped = \"succeeded\"\n        elif status == \"expired\":\n            mapped = \"failed\"\n        else:\n            mapped = \"idle\"\n        async with self:\n            self.payment_status = mapped\n            self.customer_email = email\n            self.error_message = (\n                \"Session expired\" if status == \"expired\" else \"\"\n            )\n        logger.info(\"Session %s status: %s\", session_id, status)\n    except Exception as e:\n        logger.error(\"Failed to retrieve session status: %s\", e)\n        async with self:\n            self.payment_status = \"failed\"\n            self.error_message = str(e)\n</code></pre>"},{"location":"api_reference/#reflex_stripe.stripe_state.StripeState.get_payment_status","title":"<code>get_payment_status()</code>  <code>async</code>","text":"<p>Retrieve PaymentIntent status from URL query params.</p> <p>Reads <code>payment_intent</code> from <code>self.router.page.params</code> and calls the Stripe API to get intent status.  Designed as an <code>on_load</code> handler for Express Checkout return pages.</p> Source code in <code>custom_components/reflex_stripe/stripe_state.py</code> <pre><code>@rx.event(background=True)\nasync def get_payment_status(self):\n    \"\"\"Retrieve PaymentIntent status from URL query params.\n\n    Reads ``payment_intent`` from ``self.router.page.params`` and calls\n    the Stripe API to get intent status.  Designed as an ``on_load``\n    handler for Express Checkout return pages.\n    \"\"\"\n    params = self.router.page.params\n    pi_id = params.get(\"payment_intent\", \"\")\n    if not pi_id:\n        # Also check redirect_status for a quick signal\n        redirect_status = params.get(\"redirect_status\", \"\")\n        if redirect_status == \"succeeded\":\n            async with self:\n                self.payment_status = \"succeeded\"\n                self.error_message = \"\"\n        return\n\n    try:\n        client = self._get_client()\n        intent = await client.v1.payment_intents.retrieve_async(pi_id)\n        status = intent.status or \"\"\n        # Map PaymentIntent status \u2192 payment_status field\n        if status == \"succeeded\":\n            mapped = \"succeeded\"\n        elif status == \"processing\":\n            mapped = \"processing\"\n        elif status in (\"requires_payment_method\", \"requires_action\"):\n            mapped = \"failed\"\n        else:\n            mapped = status\n        async with self:\n            self.payment_status = mapped\n            self.error_message = (\n                \"Payment requires another attempt\"\n                if mapped == \"failed\"\n                else \"\"\n            )\n        logger.info(\"PaymentIntent %s status: %s\", pi_id, status)\n    except Exception as e:\n        logger.error(\"Failed to retrieve payment intent status: %s\", e)\n        async with self:\n            self.payment_status = \"failed\"\n            self.error_message = str(e)\n</code></pre>"},{"location":"api_reference/#models","title":"Models","text":"<p>               Bases: <code>PropsBase</code></p> <p>Stripe Elements appearance configuration.</p> <p>See: https://docs.stripe.com/elements/appearance-api</p> Source code in <code>custom_components/reflex_stripe/models.py</code> <pre><code>class Appearance(PropsBase):\n    \"\"\"Stripe Elements appearance configuration.\n\n    See: https://docs.stripe.com/elements/appearance-api\n    \"\"\"\n\n    theme: LiteralTheme | None = None\n    variables: Variables | None = None\n    rules: dict[str, dict[str, str]] | None = None\n    labels: Literal[\"above\", \"floating\"] | None = None\n    disable_animations: bool | None = None\n</code></pre> <p>               Bases: <code>PropsBase</code></p> <p>Stripe Elements appearance variables.</p> <p>See: https://docs.stripe.com/elements/appearance-api?platform=web#variables</p> Source code in <code>custom_components/reflex_stripe/models.py</code> <pre><code>class Variables(PropsBase):\n    \"\"\"Stripe Elements appearance variables.\n\n    See: https://docs.stripe.com/elements/appearance-api?platform=web#variables\n    \"\"\"\n\n    font_family: str = \"\"\n    font_size_base: str = \"\"\n    spacing_unit: str = \"\"\n    border_radius: str = \"\"\n    color_primary: str = \"\"\n    color_background: str = \"\"\n    color_text: str = \"\"\n    color_danger: str = \"\"\n    color_success: str = \"\"\n    color_warning: str = \"\"\n    color_text_secondary: str = \"\"\n    color_text_placeholder: str = \"\"\n    color_icon: str = \"\"\n    color_icon_tab: str = \"\"\n    color_icon_tab_selected: str = \"\"\n    focus_box_shadow: str = \"\"\n    focus_outline: str = \"\"\n</code></pre> <p>               Bases: <code>PropsBase</code></p> <p>Options for ExpressCheckoutElement.</p> <p>See: https://docs.stripe.com/elements/express-checkout-element</p> Source code in <code>custom_components/reflex_stripe/models.py</code> <pre><code>class ExpressCheckoutOptions(PropsBase):\n    \"\"\"Options for ExpressCheckoutElement.\n\n    See: https://docs.stripe.com/elements/express-checkout-element\n    \"\"\"\n\n    button_height: int | None = None\n    button_theme: ButtonTheme | None = None\n    button_type: ButtonType | None = None\n    layout: ExpressCheckoutLayout | None = None\n    payment_methods: PaymentMethods | None = None\n    payment_method_order: list[str] | None = None\n    email_required: bool | None = None\n    phone_number_required: bool | None = None\n</code></pre> <p>               Bases: <code>PropsBase</code></p> <p>Layout options for Express Checkout Element.</p> Source code in <code>custom_components/reflex_stripe/models.py</code> <pre><code>class ExpressCheckoutLayout(PropsBase):\n    \"\"\"Layout options for Express Checkout Element.\"\"\"\n\n    max_columns: int | None = None\n    max_rows: int | None = None\n    overflow: Literal[\"auto\", \"never\"] | None = None\n</code></pre> <p>               Bases: <code>PropsBase</code></p> <p>Button theme options per payment method.</p> Source code in <code>custom_components/reflex_stripe/models.py</code> <pre><code>class ButtonTheme(PropsBase):\n    \"\"\"Button theme options per payment method.\"\"\"\n\n    apple_pay: Literal[\"black\", \"white\", \"white-outline\"] | None = None\n    google_pay: Literal[\"black\", \"white\"] | None = None\n    paypal: Literal[\"gold\", \"blue\", \"silver\", \"white\", \"black\"] | None = None\n</code></pre> <p>               Bases: <code>PropsBase</code></p> <p>Button type/label options per payment method.</p> Source code in <code>custom_components/reflex_stripe/models.py</code> <pre><code>class ButtonType(PropsBase):\n    \"\"\"Button type/label options per payment method.\"\"\"\n\n    apple_pay: (\n        Literal[\n            \"add-money\",\n            \"book\",\n            \"buy\",\n            \"check-out\",\n            \"contribute\",\n            \"donate\",\n            \"order\",\n            \"plain\",\n            \"reload\",\n            \"rent\",\n            \"subscribe\",\n            \"support\",\n            \"tip\",\n            \"top-up\",\n        ]\n        | None\n    ) = None\n    google_pay: (\n        Literal[\n            \"book\",\n            \"buy\",\n            \"checkout\",\n            \"donate\",\n            \"order\",\n            \"pay\",\n            \"plain\",\n            \"subscribe\",\n        ]\n        | None\n    ) = None\n    paypal: Literal[\"paypal\", \"buynow\", \"checkout\", \"pay\"] | None = None\n</code></pre> <p>               Bases: <code>PropsBase</code></p> <p>Payment method visibility options.</p> Source code in <code>custom_components/reflex_stripe/models.py</code> <pre><code>class PaymentMethods(PropsBase):\n    \"\"\"Payment method visibility options.\"\"\"\n\n    apple_pay: Literal[\"always\", \"auto\", \"never\"] | None = None\n    google_pay: Literal[\"always\", \"auto\", \"never\"] | None = None\n    link: Literal[\"auto\", \"never\"] | None = None\n    paypal: Literal[\"auto\", \"never\"] | None = None\n</code></pre>"},{"location":"getting_started/","title":"Getting Started","text":""},{"location":"getting_started/#installation","title":"Installation","text":"<pre><code>pip install reflex-stripe\n</code></pre> <p>Or with uv:</p> <pre><code>uv add reflex-stripe\n</code></pre>"},{"location":"getting_started/#environment-variables","title":"Environment Variables","text":"<p>Set your Stripe keys as environment variables:</p> <pre><code>export STRIPE_PUBLISHABLE_KEY=\"pk_test_...\"\nexport STRIPE_SECRET_KEY=\"sk_test_...\"\n</code></pre> <p>Tip</p> <p>Get your test keys from the Stripe Dashboard.</p>"},{"location":"getting_started/#quick-start","title":"Quick Start","text":""},{"location":"getting_started/#embedded-checkout-simplest","title":"Embedded Checkout (simplest)","text":"<p>Add a full Stripe checkout page to your app in 5 lines:</p> <pre><code>import reflex as rx\nimport reflex_stripe as stripe\n\napp = rx.App()\nstripe.add_checkout_page(\n    app,\n    line_items=[{\"price\": \"price_xxx\", \"quantity\": 1}],\n)\n</code></pre> <p>This creates:</p> <ul> <li><code>/checkout</code> \u2014 Embedded Stripe checkout form</li> <li><code>/checkout/return</code> \u2014 Return page with payment status</li> </ul>"},{"location":"getting_started/#express-checkout-apple-pay-google-pay","title":"Express Checkout (Apple Pay / Google Pay)","text":"<pre><code>import reflex as rx\nimport reflex_stripe as stripe\n\napp = rx.App()\nstripe.add_express_checkout_page(app, amount=2000, currency=\"usd\")\n</code></pre> <p>This creates:</p> <ul> <li><code>/express-checkout</code> \u2014 Express wallet buttons (Apple Pay, Google Pay, Link)</li> <li><code>/express-checkout/complete</code> \u2014 Return page with payment status</li> </ul>"},{"location":"getting_started/#custom-integration","title":"Custom Integration","text":"<p>For more control, compose components explicitly:</p> <pre><code>import os\nimport reflex as rx\nimport reflex_stripe as stripe\n\n\ndef checkout_page() -&gt; rx.Component:\n    return stripe.stripe_provider(\n        stripe.ExpressCheckoutBridge.create(\n            return_url=\"/checkout/complete\",\n        ),\n        publishable_key=os.environ[\"STRIPE_PUBLISHABLE_KEY\"],\n        secret_key=os.environ[\"STRIPE_SECRET_KEY\"],\n        mode=\"payment\",\n        amount=1099,\n        currency=\"usd\",\n    )\n\n\napp = rx.App()\nstripe.register_stripe_api(app)\napp.add_page(checkout_page, route=\"/checkout\")\n</code></pre>"},{"location":"getting_started/#api-routes","title":"API Routes","text":"<p>The library registers three API endpoints on your Reflex app:</p> Endpoint Method Purpose <code>/api/stripe/create-payment-intent</code> POST Creates a PaymentIntent (Express Checkout) <code>/api/stripe/create-checkout-session</code> POST Creates a Checkout Session (Embedded Checkout) <code>/api/stripe/session-status</code> GET Retrieves session status (return pages) <p>Routes are auto-registered when you use <code>add_checkout_page()</code> or <code>add_express_checkout_page()</code>. For manual composition, call <code>stripe.register_stripe_api(app)</code>.</p>"},{"location":"getting_started/#components-reference","title":"Components Reference","text":""},{"location":"getting_started/#page-helpers","title":"Page Helpers","text":"<ul> <li><code>add_checkout_page(app, ...)</code> \u2014 Adds Embedded Checkout page + return page</li> <li><code>add_express_checkout_page(app, ...)</code> \u2014 Adds Express Checkout page + return page</li> <li><code>checkout_return_page()</code> \u2014 Standalone return page component</li> </ul>"},{"location":"getting_started/#provider-elements","title":"Provider &amp; Elements","text":"<ul> <li><code>stripe_provider(*children, publishable_key, ...)</code> \u2014 Wraps children in <code>&lt;Elements&gt;</code> with <code>loadStripe()</code></li> <li><code>ExpressCheckoutBridge.create(return_url, ...)</code> \u2014 Express wallet buttons with auto payment flow</li> <li><code>embedded_checkout_session(publishable_key, secret_key, line_items, ...)</code> \u2014 Embedded checkout form</li> </ul>"},{"location":"getting_started/#state","title":"State","text":"<ul> <li><code>StripeState</code> \u2014 Backend state managing <code>payment_status</code>, <code>error_message</code>, <code>customer_email</code></li> <li><code>StripeState.get_session_status</code> \u2014 <code>on_load</code> handler for Embedded Checkout return pages</li> <li><code>StripeState.get_payment_status</code> \u2014 <code>on_load</code> handler for Express Checkout return pages</li> </ul>"},{"location":"getting_started/#configuration-models","title":"Configuration Models","text":"<ul> <li><code>Appearance</code> \u2014 Stripe Elements appearance configuration</li> <li><code>ExpressCheckoutOptions</code> \u2014 Express Checkout button options</li> <li><code>ButtonTheme</code>, <code>ButtonType</code> \u2014 Button styling</li> <li><code>ExpressCheckoutLayout</code> \u2014 Layout options (maxRows, overflow)</li> <li><code>Variables</code> \u2014 CSS variables for theming</li> </ul>"}]}